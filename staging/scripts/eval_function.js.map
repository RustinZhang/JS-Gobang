{"version":3,"sources":["eval_function.js"],"names":["Eval","_pos_val","pos","board","countFive","p_val","turn_w","color","val_w","val_b","types_black","five","four","sfour","three","sthree","two","stwo","types_white","typesCount","i","j","posY","b","posX","temp_arr","push","origin","undefined","line_to_analysis","game_over","count_five","count_four","count_sfour","count_three","count_sthree","count_two","count_stwo","stone_qty","side","line","length","l","len","temp","count","splice","stones","row","col","right_falling","rising","lineAnalysis","getRow","accumulate","getCol","getRightFalling","getRising","Y","X","rf","ri","getScore"],"mappings":"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","file":"eval_function.js","sourcesContent":["/**\n * @fileOverview 估值核心模块，直接影响 AI 的智能程度。\n */\n\"use strict\";\n/**\n * @module eval_function\n */\n\n\n/**\n * 评估核心类\n */\nclass Eval {\n    /**\n     * get the position value\n     * @returns {Array}\n     */\n    get pos_val() {\n        return this._pos_val\n    }\n    \n    constructor() {\n        /**\n         * 棋盘上每个位置的权重，越靠近中心权重越高\n         * @type {Array}\n         */\n        this._pos_val = [\n            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n            [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0],\n            [0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 0],\n            [0, 1, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 1, 0],\n            [0, 1, 2, 3, 4, 4, 4, 4, 4, 4, 4, 3, 2, 1, 0],\n            [0, 1, 2, 3, 4, 5, 5, 5, 5, 5, 4, 3, 2, 1, 0],\n            [0, 1, 2, 3, 4, 5, 6, 6, 6, 5, 4, 3, 2, 1, 0],\n            [0, 1, 2, 3, 4, 5, 6, 7, 6, 5, 4, 3, 2, 1, 0],\n            [0, 1, 2, 3, 4, 5, 6, 6, 6, 5, 4, 3, 2, 1, 0],\n            [0, 1, 2, 3, 4, 5, 5, 5, 5, 5, 4, 3, 2, 1, 0],\n            [0, 1, 2, 3, 4, 4, 4, 4, 4, 4, 4, 3, 2, 1, 0],\n            [0, 1, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 1, 0],\n            [0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 0],\n            [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0],\n            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        ];\n    }\n    \n    /**\n     * 行的一维抽象\n     * @param posY {number} 当前位置的Y值\n     * @param b {Array} 当前棋盘\n     * @returns {Array} 当前行的数组\n     */\n    static getRow(posY, b) {\n        return b[posY];\n    }\n    \n    /**\n     * 列的一维抽象，同理\n     * @param posX {number}\n     * @param b {Array}\n     * @returns {Array}\n     */\n    static getCol(posX, b) {\n        let temp_arr = [];\n        for (let i = 0; i < 15; i++) {\n            temp_arr.push(b[i][posX]);\n        }\n        return temp_arr;\n    }\n    \n    /**\n     *\n     * @param origin {number}\n     * @param b {Array} 当前棋盘\n     * @returns {Array}\n     */\n    static getRightFalling(origin, b) {\n        let temp_arr = [];\n        if (origin < -10 || origin > 10) return undefined;\n        for (let i = origin <= 0 ? 0 : origin; i <= (origin < 0 ? 14 + origin : 14); i++) {\n            temp_arr.push(b[i][i - origin]);\n        }\n        return temp_arr;\n    }\n    \n    /**\n     *\n     * @param origin {number}\n     * @param b {Array}\n     * @returns {Array}\n     */\n    static getRising(origin, b) {\n        let temp_arr = [];\n        if (origin < 4 || origin > 24) return undefined;\n        for (let i = origin >= 15 ? origin - 14 : 0; i <= (origin > 14 ? 14 : origin); i++) {\n            temp_arr.push(b[i][origin - i]);\n        }\n        return temp_arr;\n    }\n    \n    /**\n     * lineAnalysis 直线分析函数，负责分析以上四个静态方法得到的数组，计算每种棋型的数量，这是比较容易出错的位置。因为这个部分一开始就使用了自己的逻辑，所以从二维一维化到直线分析函数都没有参考其他资料，也可能会有逻辑上的漏洞，目前来看数据的抽象应该没有大问题，评分逻辑和效率还有待优化，这两个方面耦合得比较深，是无法分开的。\n     * @param line_to_analysis {Array}\n     * @param color {boolean}\n     * @param [game_over=false] {boolean}\n     * @returns {*}\n     */\n    static lineAnalysis(line_to_analysis, color, game_over = false) {\n        if (line_to_analysis === undefined) {\n            return {\n                five  : 0,\n                four  : 0,\n                sfour : 0,\n                three : 0,\n                sthree: 0,\n                two   : 0,\n                stwo  : 0\n            }\n        }\n        \n        let count_five,\n        count_four = 0,\n        count_sfour = 0,\n        count_three = 0,\n        count_sthree = 0,\n        count_two = 0,\n        count_stwo = 0,\n        stone_qty = 0,\n        side = typeof color === \"string\" ? color : color.color,\n        line = Array.from(line_to_analysis),\n        length = line.length;\n        \n        for (let i = 0; i < length; i++) {\n            if (side === \"black\") {\n                if (line[i] === 1) {\n                    line[i] = 0;\n                } else if (line[i] === 0) {\n                    line[i] = 1;\n                    stone_qty++;\n                }\n            } else {\n                if (line[i] === 1) stone_qty++;\n            }\n            \n        }\n        \n        count_five = (function(l = line, len = length) {\n            if (stone_qty < 5) return 0;\n            let temp = 1;\n            for (let i = 0; i < len; i++) {\n                if ((l[i] === 1) && (l[i] === l[i + 1])) temp++;\n                if (l[i] !== 1) temp = 1;\n                if (temp === 5) return 1;\n            }\n            return 0;\n        })();\n        \n        if (game_over) return count_five;\n        \n        if (count_five !== 0) {\n            return {\n                five  : count_five,\n                four  : count_four,\n                sfour : count_sfour,\n                three : count_three,\n                sthree: count_sthree,\n                two   : count_two,\n                stwo  : count_stwo\n            }\n        }\n        \n        count_four = (function(l = line, len = length) {\n            if (stone_qty < 4) return 0;\n            let temp = 1, count = 0;\n            for (let i = 1; i < len && stone_qty > 3; i++) {\n                if ((l[i] === 1) && (l[i] === l[i + 1])) temp++;\n                if (l[i] !== 1) temp = 1;\n                if (temp === 4 && l[i - 3] !== 0 && l[i + 2] !== 0 && i < len - 2 && l[i + 1] === 1) {\n                    l.splice(i - 2, 4, \"f\", \"f\", \"f\", \"f\");\n                    temp = 1;\n                    count++;\n                    stone_qty -= 4;\n                    i++;\n                }\n            }\n            return count;\n        })();\n        \n        count_sfour = (function(l = line, len = length) {\n            if (stone_qty < 4) return 0;\n            let temp = 1, count = 0;\n            for (let i = 0; i < len && stone_qty > 3; i++) {\n                if ((l[i] === 1) && (l[i] === l[i + 1])) temp++;\n                if (l[i] !== 1) temp = 1;\n                if (temp === 4 && l[i + 1] === 1) {\n                    if ((i - 2 !== 0 && l[i - 3] !== 0) || ((i < len - 2) && l[i + 2] !== 0)) {\n                        count++;\n                        l.splice(i - 2, 4, \"sf\", \"sf\", \"sf\", \"sf\");\n                        temp = 1;\n                        stone_qty -= 4;\n                        i++;\n                    }\n                    if (temp === 3) {\n                        if (l[i - 2] === undefined && l[i - 3] === 1) {\n                            count++;\n                            l.splice(i - 1, 3, \"sf\", \"sf\", \"sf\");\n                            temp = 1;\n                            stone_qty -= 3;\n                            i++;\n                        }\n                        if (l[i + 2] === undefined && l[i + 3] === 1) {\n                            count++;\n                            l.splice(i - 1, 3, \"sf\", \"sf\", \"sf\");\n                            temp = 1;\n                            stone_qty -= 3;\n                            i += 2;\n                        }\n                    }\n                    if (temp === 2) {\n                        if (l[i + 2] === undefined && l[i + 3] === 1 && l[i + 4] === 1) {\n                            count++;\n                            l.splice(i, 2, \"sf\", \"sf\");\n                            temp = 1;\n                            stone_qty -= 2;\n                            i += 2;\n                        }\n                    }\n                }\n            }\n            return count;\n        })();\n        \n        count_three = (function(l = line, len = length) {\n            if (stone_qty < 3) return 0;\n            let temp = 1, count = 0;\n            for (let i = 1; i < len && stone_qty > 2; i++) {\n                if (l[i] === 1 && l[i] === l[i + 1]) temp++;\n                if (l[i] !== 1) temp = 1;\n                if (temp === 3) {\n                    if (l[i - 2] === undefined && l[i + 2] === undefined && (i < len - 2)) {\n                        // exclude fake three: 0/border,undefined,1,1,1,undefined,0/border\n                        if (!(l[i - 3] === 0 || i - 2 === 0) || !(l[i + 3] === 0 || i === len - 3)) {\n                            count++;\n                            temp = 1;\n                            l.splice(i - 1, 3, \"t\", \"t\", \"t\");\n                            stone_qty -= 3;\n                        }\n                    }\n                }\n                if (temp === 2) {\n                    if (l[i + 2] === undefined && l[i + 3] === 1 && l[i + 4] === undefined && l[i - 1] === undefined && (i - 1 > 0) && (i < len - 5)) {\n                        count++;\n                        temp = 1;\n                        l.splice(i, 3, \"t\", \"t\", \"t\");\n                        stone_qty -= 2;\n                    }\n                    if ((l[i - 1] === undefined && l[i - 2] === 1 && l[i - 3] === undefined && l[i + 2] === undefined && (i - 3 > 0) && (i < len - 3))) {\n                        count++;\n                        temp = 1;\n                        l.splice(i - 1, 3, \"t\", \"t\", \"t\");\n                        stone_qty -= 2;\n                    }\n                }\n            }\n            return count;\n        })();\n        \n        count_sthree = (function(l = line, len = length) {\n            if (stone_qty < 3) return 0;\n            let temp = 1, count = 0;\n            for (let i = 0; i < len && stone_qty > 2; i++) {\n                if (l[i] === 1 && l[i] === l[i + 1]) temp++;\n                if (l[i] !== 1) temp = 1;\n                if (temp === 3) {\n                    if ((l[i - 3] === undefined && l[i - 2] === undefined && (i - 2) > 0) || (l[i + 2] === undefined && l[i + 3] === undefined && (i < len - 3))) {\n                        count++;\n                        temp = 1;\n                        l.splice(i - 1, 3, \"st\", \"st\", \"st\");\n                        stone_qty -= 3;\n                    }\n                    if (temp === 2) {\n                        if (l[i - 1] === undefined && l[i - 2] === 1) {\n                            if ((l[i - 3] === undefined && (i - 2) !== 0) || (l[i + 2] === undefined && (i < len - 2))) {\n                                count++;\n                                temp = 1;\n                                l.splice(i - 1, 3, \"st\", \"st\", \"st\");\n                                stone_qty -= 2;\n                            }\n                        }\n                        if (l[i + 2] === undefined && l[i + 3] === 1) {\n                            if ((l[i - 1] === undefined && i !== 0) || (l[i + 4] === undefined && (i < len - 4))) {\n                                count++;\n                                temp = 1;\n                                l.splice(i, 3, \"st\", \"st\", \"st\");\n                                stone_qty -= 2;\n                            }\n                        }\n                    }\n                    if (l[i] === 1 && l[i + 1] === undefined && l[i + 2] === 1 && l[i + 3] === undefined && l[i + 4] === 1) {\n                        count++;\n                        l.splice(i, 2, \"st\", \"st\");\n                        stone_qty -= 1;\n                    }\n                }\n            }\n            return count;\n        })();\n        \n        count_two = (function(l = line, len = length) {\n            if (stone_qty < 2) return 0;\n            let count = 0;\n            for (let i = 0; i < len && stone_qty > 1; i++) {\n                if (l[i] === 1 && l[i + 1] === 1) {\n                    if ((l[i - 1] === undefined && l[i - 2] === undefined && l[i + 2] === undefined && (i - 1 > 0)) || (l[i - 1] === undefined && l[i + 2] === undefined && l[i + 3] === undefined && i < len - 3)) {\n                        count++;\n                        stone_qty -= 2;\n                        l.splice(i, 2, \"w\", \"w\");\n                        i = +2;\n                    }\n                }\n                if (l[i] === 1 && l[i + 1] === undefined && l[i + 2] === 1) {\n                    if (l[i - 1] === undefined && (i > 0) && l[i + 3] === undefined && (i < len - 3)) {\n                        count++;\n                        stone_qty -= 1;\n                        l.splice(i, 1, \"w\");\n                        i++\n                    }\n                }\n                if (l[i] === 1 && l[i + 1] === undefined && l[i + 2] === undefined && l[i + 3] === 1) {\n                    if ((l[i - 1] === undefined && i > 0) || (l[i + 4] === undefined && i < len - 4)) {\n                        count++;\n                        stone_qty -= 1;\n                        l.splice(i, 1, \"w\");\n                        i += 2;\n                    }\n                }\n            }\n            return count;\n        })();\n        \n        count_stwo = (function(l = line, len = length) {\n            if (stone_qty < 2) return 0;\n            let count = 0;\n            for (let i = 0; i < len && stone_qty > 1; i++) {\n                if (l[i] === 1 && l[i + 1] === 1) {\n                    if (((l[i - 1] === 0 || i === 0) && l[i + 2] === undefined && l[i + 3] === undefined && l[i + 4] === undefined && (i < len - 4)) || ((i - 2 > 0) && l[i - 3] === undefined && l[i - 2] === undefined && l[i - 1] === undefined && (l[i + 2] === 0 || (i = len - 3)))) {\n                        count++;\n                        stone_qty -= 2;\n                        i++;\n                        l.splice(i, 2, \"sw\", \"sw\");\n                    }\n                }\n                if (l[i] === 1 && l[i + 1] === undefined && l[i + 2] === 1) {\n                    if (((l[i - 1] === 0 || i === 0) && l[i + 3] === undefined && l[i + 4] === undefined && (i < len - 4)) || (((i === len - 3) || l[i + 3] === 0) && l[i - 1] === undefined && l[i - 2] === undefined && (i - 1 > 0))) {\n                        count++;\n                        stone_qty -= 2;\n                        i += 2;\n                        l.splice(i, 3, \"sw\", \"sw\", \"sw\");\n                    }\n                }\n                if (l[i] === 1 && l[i + 1] === undefined && l[i + 2] === undefined && l[i + 3] === 1) {\n                    if (((l[i - 1] === 0 || i === 0) && l[i + 4] === undefined && (i < len - 4)) || (((l[i + 4] === 0) || (i = len - 4)) && l[i - 1] === undefined && i > 0)) {\n                        count++;\n                        stone_qty -= 2;\n                        i += 3;\n                        l.splice(i, 4, \"sw\", \"sw\", \"sw\", \"sw\");\n                    }\n                }\n            }\n            return count;\n        })();\n        \n        return {\n            five  : count_five,\n            four  : count_four,\n            sfour : count_sfour,\n            three : count_three,\n            sthree: count_sthree,\n            two   : count_two,\n            stwo  : count_stwo\n        }\n    }\n    \n    static accumulate(color, line) {\n        color.five += line.five;\n        color.four += line.four;\n        color.sfour += line.sfour;\n        color.three += line.three;\n        color.sthree += line.sthree;\n        color.two += line.two;\n        color.stwo += line.stwo;\n    }\n    \n    /**\n     * 汇总所有棋型的数量，按理说使用数组遍历方法可读性会更好些，但不知道函数调用对性能影响的程度，评估核心对性能要求比较苛刻，暂时直接写出循环，待测试另一种写法的效率\n     * @param color {object} 对应颜色棋子的统计\n     * @param board {Array} 当前棋盘\n     */\n    static typesCount(color, board) {\n        let temp, stones = [], row = [], col = [], right_falling = [], rising = [];\n        for (let i = 0; i < 15; i++) {\n            for (let j = 0; j < 15; j++) {\n                if (board[i][j] === 0 || board[i][j] === 1) {\n                    stones.push([i, j]);\n                }\n            }\n        }\n        \n        for (let i = 0; i < stones.length; i++) {\n            if (!row[-stones[i][0]]) {\n                row.push(stones[i][0]);\n                row[-stones[i][0]] = 1;\n            }\n            if (!col[-stones[i][1]]) {\n                col.push(stones[i][1]);\n                col[-stones[i][1]] = 1;\n            }\n            if (!right_falling[-(stones[i][0] - stones[i][1])]) {\n                right_falling.push(stones[i][0] - stones[i][1]);\n                right_falling[-(stones[i][0] - stones[i][1])] = 1;\n            }\n            if (!rising[-(stones[i][0] + stones[i][1])]) {\n                rising.push(stones[i][0] + stones[i][1]);\n                rising[-(stones[i][0] + stones[i][1])] = 1;\n            }\n        }\n        \n        for (let i = 0; i < row.length; i++) {\n            temp = this.lineAnalysis(this.getRow(row[i], board), color);\n            this.accumulate(color, temp);\n        }\n        for (let i = 0; i < col.length; i++) {\n            temp = this.lineAnalysis(this.getCol(col[i], board), color);\n            this.accumulate(color, temp);\n        }\n        for (let i = 0; i < right_falling.length; i++) {\n            temp = this.lineAnalysis(this.getRightFalling(right_falling[i], board), color);\n            this.accumulate(color, temp);\n        }\n        for (let i = 0; i < rising.length; i++) {\n            temp = this.lineAnalysis(this.getRising(rising[i], board), color);\n            this.accumulate(color, temp);\n        }\n    }\n    \n    static countFive(pos, color, board) {\n        let Y = pos.posY, X = pos.posX, rf = Y - X, ri = Y + X;\n        return (this.lineAnalysis(this.getRow(Y, board), color, true) + this.lineAnalysis(this.getCol(X, board), color, true) + this.lineAnalysis(this.getRightFalling(rf, board), color, true) + this.lineAnalysis(this.getRising(ri, board), color, true)) > 0;\n    }\n    \n    /**\n     * 判断游戏是否结束\n     * @param pos {object}\n     * @param board {Array}\n     * @returns {boolean}\n     */\n    isGameOver(pos, board) {\n        return (Eval.countFive(pos, \"white\", board) || Eval.countFive(pos, \"black\", board));\n    }\n    \n    /**\n     * 计算当前棋盘分数\n     * @param pos {object}\n     * @param board {Array}\n     * @param [p_val] {number}\n     * @returns {number}\n     */\n    evaluate(pos, board, p_val = this._pos_val) {\n        let turn_w = !pos.color,\n        val_w = 0,\n        val_b = 0,\n        types_black = {\n            color : \"black\",\n            five  : 0,\n            four  : 0,\n            sfour : 0,\n            three : 0,\n            sthree: 0,\n            two   : 0,\n            stwo  : 0\n        },\n        types_white = {\n            color : \"white\",\n            five  : 0,\n            four  : 0,\n            sfour : 0,\n            three : 0,\n            sthree: 0,\n            two   : 0,\n            stwo  : 0\n        };\n        \n        Eval.typesCount(types_black, board);\n        Eval.typesCount(types_white, board);\n        \n        // if already five early return game over\n        if (turn_w) {\n            if (types_black.five) return -9999;\n            if (types_white.five) return 9999;\n        } else {\n            if (types_white.five) return -9999;\n            if (types_black.five) return 9999;\n        }\n        \n        // 2 sfours equal to 1 four\n        if (types_white.sfour > 1) types_white.four++;\n        if (types_black.sfour > 1) types_black.four++;\n        \n        /*\n         * 以下是依据棋型给出评分，这个部分也非常依赖棋类知识，有很大的优化空间，目前这个评分模型参考的是「PC 游戏编程（人机博弈）」一书中的。\n         * 活三眠三和活二的逻辑最需要优化\n         */\n        if (turn_w) {\n            if (types_white.four) return 9990;\n            if (types_white.sfour) return 9980;\n            if (types_black.four) return -9970;\n            if (types_black.sfour && types_black.three) return -9960;\n            if (types_white.three && types_black.sfour === 0) return 9950;\n            if (types_black.three > 1 && types_white.sfour === 0 && types_white.three === 0 && types_white.sthree === 0) return -9940;\n            if (types_white.three > 1) val_w += 2000; else if (types_white.three) val_w += 200;\n            if (types_black.three > 1) val_b += 500; else if (types_black.three) val_b += 100;\n            if (types_white.sthree) val_w += types_white.sthree * 10;\n            if (types_black.sthree) val_b += types_black.sthree * 10;\n            if (types_black.two) val_b += types_black.two * 4;\n            if (types_white.two) val_w += types_white.two * 4;\n            if (types_black.stwo) val_b += types_black.stwo;\n            if (types_white.stwo) val_w += types_white.stwo;\n        } else {\n            if (types_black.four) return 9990;\n            if (types_black.sfour) return 9980;\n            if (types_white.four) return -9970;\n            if (types_white.sfour && types_white.three) return -9960;\n            if (types_black.three && types_white.sfour === 0) return 9950;\n            if (types_white.three > 1 && types_black.sfour === 0 && types_black.three === 0 && types_black.sthree === 0) return -9940;\n            if (types_black.three > 1) val_b += 2000; else if (types_black.three) val_b += 200;\n            if (types_white.three > 1) val_w += 500; else if (types_white.three) val_w += 100;\n            if (types_black.sthree) val_b += types_black.sthree * 10;\n            if (types_white.sthree) val_w += types_white.sthree * 10;\n            if (types_black.two) val_b += types_black.two * 4;\n            if (types_white.two) val_w += types_white.two * 4;\n            if (types_black.stwo) val_b += types_black.stwo;\n            if (types_white.stwo) val_w += types_white.stwo;\n        }\n        \n        for (let i = 0; i < 15; i++) {\n            for (let j = 0; j < 15; j++) {\n                if (board[i][j] === 0) val_b += p_val[i][j];\n                if (board[i][j] === 1) val_w += p_val[i][j];\n            }\n        }\n        \n        if (turn_w) {\n            return val_w - val_b;\n        } else {\n            return val_b - val_w;\n        }\n    }\n}\n/**\n *\n * @type {Eval}\n */\nexport let getScore = new Eval();\n"]}